#pragma checksum "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "b8ea1ad0678c4cb65a26eb83b5b9111a0623e018"
// <auto-generated/>
#pragma warning disable 1591
namespace BlazorRV.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\_Imports.razor"
using BlazorRV;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\_Imports.razor"
using BlazorRV.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
using GoogleMaps.LocationServices;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/forecast")]
    public partial class Forecast : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.AddMarkupContent(0, "<style>\r\n \r\n\r\n   \r\n\r\n    .localConditions {\r\n        margin-top: 20px;\r\n    }\r\n\r\n    .futureConditions {\r\n        margin-top: 20px;\r\n    }\r\n\r\n    .provider {\r\n        font-size: x-small;\r\n    }\r\n</style>\r\n\r\n\r\n");
            __builder.OpenElement(1, "div");
            __builder.AddAttribute(2, "class", "jumbotron");
            __builder.AddMarkupContent(3, "<h1 class=\"display-4\">Forecast for your Destination</h1>\r\n    ");
            __builder.OpenElement(4, "div");
            __builder.AddAttribute(5, "class", "input-group mb-3");
            __builder.OpenElement(6, "input");
            __builder.AddAttribute(7, "onkeyup", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.KeyboardEventArgs>(this, 
#nullable restore
#line 27 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                     GetWxInfo

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(8, "type", "text");
            __builder.AddAttribute(9, "class", "form-control");
            __builder.AddAttribute(10, "placeholder", "Example: Galveston, TX or 77551");
            __builder.AddAttribute(11, "aria-label", "Recipient\'s username");
            __builder.AddAttribute(12, "aria-describedby", "basic-addon2");
            __builder.AddAttribute(13, "value", Microsoft.AspNetCore.Components.BindConverter.FormatValue(
#nullable restore
#line 27 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                                       location

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(14, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.CreateBinder(this, __value => location = __value, location));
            __builder.SetUpdatesAttributeName("value");
            __builder.CloseElement();
            __builder.AddMarkupContent(15, "\r\n    ");
            __builder.OpenElement(16, "div");
            __builder.AddAttribute(17, "class", "input-group-append");
            __builder.OpenElement(18, "button");
            __builder.AddAttribute(19, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 29 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                          GetWxInfo

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(20, "class", "btn btn-outline-secondary");
            __builder.AddAttribute(21, "type", "button");
            __builder.AddContent(22, "Go");
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(23, "\r\n\r\n");
            __builder.OpenElement(24, "div");
            __builder.AddAttribute(25, "class", "localConditions");
#nullable restore
#line 35 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
 if (!(localConditions == null))
{

#line default
#line hidden
#nullable disable
            __builder.OpenElement(26, "p");
            __builder.OpenElement(27, "strong");
            __builder.AddContent(28, "Current Conditions for ");
            __builder.AddContent(29, 
#nullable restore
#line 37 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                                       localConditions.Name

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(30, " (");
            __builder.AddContent(31, 
#nullable restore
#line 37 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                                                              localConditions.Coord.Lat

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(32, " , ");
            __builder.AddContent(33, 
#nullable restore
#line 37 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                                                                                           localConditions.Coord.Lon

#line default
#line hidden
#nullable disable
            );
            __builder.AddMarkupContent(34, ")\r\n        ");
            __builder.OpenElement(35, "em");
            __builder.AddContent(36, "(as of ");
            __builder.AddContent(37, 
#nullable restore
#line 38 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                    UnixTimeStampToDateTime(@localConditions.Dt)

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(38, ")");
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.AddMarkupContent(39, "<br>\r\n\r\n        Current Conditions:\r\n");
#nullable restore
#line 41 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
         foreach (var desc in @localConditions.weather)
        {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(40, "span");
            __builder.AddContent(41, 
#nullable restore
#line 43 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                   desc.Description

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 44 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
        }

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(42, "<br>\r\n        Current Temperature (Feels Like): ");
            __builder.AddContent(43, 
#nullable restore
#line 46 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                                           localConditions.Main.Temp

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(44, " F (");
            __builder.AddContent(45, 
#nullable restore
#line 46 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                                                                         localConditions.Main.Feels_Like

#line default
#line hidden
#nullable disable
            );
            __builder.AddMarkupContent(46, " F) <br>\r\n        High for today: ");
            __builder.AddContent(47, 
#nullable restore
#line 47 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         localConditions.Main.Temp_Max

#line default
#line hidden
#nullable disable
            );
            __builder.AddMarkupContent(48, " F <br>\r\n        Low for today: ");
            __builder.AddContent(49, 
#nullable restore
#line 48 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                        localConditions.Main.Temp_Min

#line default
#line hidden
#nullable disable
            );
            __builder.AddMarkupContent(50, " F <br>\r\n        Pressure: ");
            __builder.AddContent(51, 
#nullable restore
#line 49 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                   localConditions.Main.Pressure

#line default
#line hidden
#nullable disable
            );
            __builder.AddMarkupContent(52, " hPa <br>\r\n        Humidity: ");
            __builder.AddContent(53, 
#nullable restore
#line 50 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                   localConditions.Main.Humidity

#line default
#line hidden
#nullable disable
            );
            __builder.AddMarkupContent(54, " % <br>\r\n        Winds: ");
            __builder.AddContent(55, 
#nullable restore
#line 51 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                localConditions.Wind.Speed

#line default
#line hidden
#nullable disable
            );
            __builder.AddMarkupContent(56, " mph\r\n");
#nullable restore
#line 52 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
         if (@localConditions.Wind.Gust > 0)
        {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(57, "span");
            __builder.AddContent(58, "gusting to ");
            __builder.AddContent(59, 
#nullable restore
#line 54 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                              localConditions.Wind.Gust

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(60, " mph ");
            __builder.CloseElement();
#nullable restore
#line 55 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
        }

#line default
#line hidden
#nullable disable
#nullable restore
#line 56 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
         if (@localConditions.Wind.Deg >= 0)
        {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(61, "span");
            __builder.AddContent(62, "from the ");
            __builder.AddContent(63, 
#nullable restore
#line 58 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                            degToCompass(@localConditions.Wind.Deg)

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 59 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
        }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
#nullable restore
#line 61 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
}

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(64, "\r\n\r\n");
            __builder.OpenElement(65, "div");
            __builder.AddAttribute(66, "class", "futureConditions");
#nullable restore
#line 65 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
 if (!(futureConditions == null))
{

#line default
#line hidden
#nullable disable
            __builder.OpenElement(67, "p");
            __builder.AddMarkupContent(68, "<strong>Forecast at a glance</strong>\r\n    ");
            __builder.OpenElement(69, "table");
            __builder.AddAttribute(70, "class", "table");
            __builder.AddMarkupContent(71, @"<thead><tr><th>Date</th>
                <th>Conditions</th>
                <th>High (F)</th>
                <th>Low (F)</th>
                <th>Wind (mph)</th>
                <th>Precip Chance (%)</th>
                <th>Pressure (hPa)</th>
                <th>Humidity (%)</th>
                <th>Dewpoint (F)</th></tr></thead>
        ");
            __builder.OpenElement(72, "tbody");
#nullable restore
#line 83 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                 foreach (var cond in @futureConditions.Daily)
                {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(73, "tr");
            __builder.OpenElement(74, "td");
            __builder.AddContent(75, 
#nullable restore
#line 86 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         UnixTimeStampToDateTime(@cond.Dt).ToShortDateString()

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(76, "\r\n                    ");
            __builder.OpenElement(77, "td");
#nullable restore
#line 88 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         foreach (var wxDesc in @cond.Weather)
                            {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(78, "span");
            __builder.AddContent(79, 
#nullable restore
#line 90 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                                       wxDesc.Description

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 91 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                            }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(80, "\r\n                    ");
            __builder.OpenElement(81, "td");
            __builder.AddContent(82, 
#nullable restore
#line 93 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         cond.Temp.Max

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(83, "\r\n                    ");
            __builder.OpenElement(84, "td");
            __builder.AddContent(85, 
#nullable restore
#line 94 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         cond.Temp.Min

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(86, "\r\n                    ");
            __builder.OpenElement(87, "td");
            __builder.AddContent(88, 
#nullable restore
#line 95 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         cond.Wind_Speed

#line default
#line hidden
#nullable disable
            );
#nullable restore
#line 96 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         if (@cond.Wind_Deg >= 0)
                        {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(89, "span");
            __builder.AddContent(90, 
#nullable restore
#line 98 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                                    degToCompass(@cond.Wind_Deg)

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
#nullable restore
#line 99 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                        }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(91, "\r\n                    ");
            __builder.OpenElement(92, "td");
            __builder.AddContent(93, 
#nullable restore
#line 100 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         ConvertPopChance(@cond.Pop)

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(94, "\r\n                    ");
            __builder.OpenElement(95, "td");
            __builder.AddContent(96, 
#nullable restore
#line 101 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         cond.Pressure

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(97, "\r\n                    ");
            __builder.OpenElement(98, "td");
            __builder.AddContent(99, 
#nullable restore
#line 102 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         cond.Humidity

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(100, "\r\n                    ");
            __builder.OpenElement(101, "td");
            __builder.AddContent(102, 
#nullable restore
#line 103 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                         cond.Dew_Point

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 105 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
                }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.CloseElement();
            __builder.CloseElement();
#nullable restore
#line 109 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
}

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(103, "\r\n\r\n");
            __builder.AddMarkupContent(104, "<div><p class=\"provider\"><em>API provided by OpenWeathermap.org</em></p></div>");
        }
        #pragma warning restore 1998
#nullable restore
#line 116 "C:\Users\ndavisjr\Desktop\workspace\BlazorRV\Pages\Forecast.razor"
       
    private string apikey = "445c6319af922ff980fcf2a1cbb6b22e";
    private string location, city, state, url;
    private double lat, lon = 0;
    private FutureConditions futureConditions;
    private LocalConditions localConditions;

    private async Task GetWxInfo()
    {
        await GetLocalConditions();

        lat = localConditions.Coord.Lat;
        lon = localConditions.Coord.Lon;
        await GetFutureConditions();
    }

    private async Task GetLocalConditions()
    {
        // Do we have a zip code or city, state
        var isNumeric = int.TryParse(location, out int zip);
        
        if (isNumeric)
        {
            url = $"https://api.openweathermap.org/data/2.5/weather?zip={zip},us&appid={apikey}&units=imperial";
        }
        else{
            string[] locationDetails = location.Split(',');
            city = locationDetails[0];
            state = "US-" + locationDetails[1].Trim();

            url = $"https://api.openweathermap.org/data/2.5/weather?q={city},{state}&appid={apikey}&units=imperial";
        }

        localConditions = await Http.GetFromJsonAsync<LocalConditions>(url);
    }

    private async Task GetFutureConditions()
    {
        var exclude = "current,minutely,hourly,alerts";

        url =
        $"https://api.openweathermap.org/data/2.5/onecall?lat={lat}&lon={lon}&exclude={exclude}&appid={apikey}&units=imperial";

        futureConditions = await Http.GetFromJsonAsync<FutureConditions>(url);
    }

    public class LocalConditions
    {
        public Coordinates Coord { get; set; }
        public CurrentWeather[] weather { get; set; }
        public MainCond Main { get; set; }
        public WindCond Wind { get; set; }
        public double Dt { get; set; }
        public string Name { get; set; }
    }

    public class Coordinates
    {
        public double Lat { get; set; }
        public double Lon { get; set; }
    }

    public class CurrentWeather
    {
        public int Id { get; set; }
        public string Main { get; set; }
        public string Description { get; set; }
    }

    public class MainCond
    {
        public double Temp { get; set; }
        public double Feels_Like { get; set; }
        public double Temp_Min { get; set; }
        public double Temp_Max { get; set; }
        public double Pressure { get; set; }
        public double Humidity { get; set; }
    }

    public class WindCond
    {
        public double Speed { get; set; }
        public int Deg { get; set; }
        public double Gust { get; set; }
    }

    public class FutureConditions
    {
        public double Lat { get; set; }
        public double Lon { get; set; }
        public DailyCond[] Daily { get; set; }

    }

    public class DailyCond
    {
        public double Dt { get; set; }
        public DailyTemp Temp { get; set; }
        public double Pop { get; set; }
        public double Pressure { get; set; }
        public double Humidity { get; set; }
        public double Dew_Point { get; set; }
        public double Wind_Speed { get; set; }
        public double Wind_Deg { get; set; }
        public DailyWeather[] Weather { get; set; }
    }

    public class DailyTemp
    {
        public double Min { get; set; }
        public double Max { get; set; }
    }

    public class DailyWeather
    {
        public int Id { get; set; }
        public string Main { get; set; }
        public string Description { get; set; }
    }

    private string degToCompass(double degrees)
    {
        degrees *= 10;

        string[] caridnals = { "N", "NNE", "NE", "ENE", "E", "ESE", "SE", "SSE", "S", "SSW", "SW", "WSW", "W", "WNW", "NW",
"NNW", "N" };
        return caridnals[(int)Math.Round(((double)degrees % 3600) / 225)];
    }

    public DateTime UnixTimeStampToDateTime(double unixTimeStamp)
    {
        // Unix timestamp is seconds past epoch
        System.DateTime dtDateTime = new DateTime(1970, 1, 1, 0, 0, 0, 0, System.DateTimeKind.Utc);
        dtDateTime = dtDateTime.AddSeconds(unixTimeStamp).ToLocalTime();
        return dtDateTime;
    }

    private int ConvertPopChance(double pop)
    {
        return (int)((double)pop * 100);
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HttpClient Http { get; set; }
    }
}
#pragma warning restore 1591
